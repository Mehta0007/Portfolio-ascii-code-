---
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import { formatDate } from "@/utils/format-date";
import RandomAsciiImage from "@/components/ascii/random-ascii-image";
import { ASCII_IMAGE_PATHS } from "@/components/ascii/constants/random-ascii-images.config";
import AttachCopyToCode from "@/components/blog/AttachCopyToCode.astro";
import AttachAnchors from "@/components/blog/AttachAnchors.astro";
import BackToAllPosts from "@/components/blog/BackToAllPosts.astro";
import { ME } from "@/constants/me";
import type { Frontmatter } from "@/utils/blog";

interface Props {
  frontmatter: Frontmatter;
}

const { frontmatter } = Astro.props;
---

<Layout title={`${frontmatter.title} | ${ME.name}`} description={frontmatter.description}>
  <div class="relative z-10 min-h-screen flex flex-col">
    <Header currentPage="blog" />

    <main class="w-full max-w-4xl mx-auto px-4 pb-8 flex-1" transition:name="main-content">
      <BackToAllPosts class="mb-4" />
      <article class="prose prose-zinc dark:prose-invert max-w-none blog-prose">
        <header class="mb-8 not-prose">
          <h1 class="font-mono text-2xl md:text-3xl mb-2">{frontmatter.title}</h1>
          <time datetime={frontmatter.date.toISOString()} class="font-mono text-sm text-zinc-500 dark:text-zinc-400">
            {formatDate(frontmatter.date)}
          </time>
        </header>

        <slot />
      </article>
      <BackToAllPosts class="mt-8" />
    </main>

    <Footer />
  </div>
  <RandomAsciiImage client:idle images={ASCII_IMAGE_PATHS.blog} className="opacity-20" />
  <AttachCopyToCode />
  <AttachAnchors />
</Layout>



<style>
  /* Proper Tailwind Prose Override */

  .blog-prose {
    font-family: "Geist", system-ui, sans-serif;
    font-size: 1.05rem;
    line-height: 1.75;

    /* Light mode */
    --tw-prose-body: #18181b;
    --tw-prose-headings: #09090b;
    --tw-prose-links: #2563eb;
    --tw-prose-bold: #09090b;
    --tw-prose-code: #09090b;
    --tw-prose-quotes: #3f3f46;

    /* Dark mode */
    --tw-prose-invert-body: #e4e4e7;
    --tw-prose-invert-headings: #fafafa;
    --tw-prose-invert-links: #60a5fa;
    --tw-prose-invert-bold: #fafafa;
    --tw-prose-invert-code: #fafafa;
    --tw-prose-invert-quotes: #d4d4d8;
  }

  .blog-prose h1,
  .blog-prose h2,
  .blog-prose h3 {
    font-weight: 700;
    letter-spacing: -0.015em;
    margin-top: 2.2rem;
    margin-bottom: 1rem;
  }

  .blog-prose h1 {
    font-size: 2.3rem;
  }

  .blog-prose h2 {
    font-size: 1.8rem;
  }

  .blog-prose h3 {
    font-size: 1.4rem;
  }

  .blog-prose p {
    margin: 1.2rem 0;
  }

  .blog-prose code {
    font-family: "Geist Mono", monospace;
    background: rgba(0, 0, 0, 0.05);
    padding: 0.2em 0.4em;
    border-radius: 4px;
  }

  .dark .blog-prose code {
    background: rgba(255, 255, 255, 0.08);
  }

  .blog-prose pre {
    background: #020617;
    color: #e5e7eb;
    padding: 1.2rem;
    border-radius: 10px;
    overflow-x: auto;
    margin: 1.5rem 0;
  }

  .blog-prose pre code {
    background: none;
    padding: 0;
  }
</style>
